catalog_data:
  foo:
    numbers:
      - { "_id": 0, "a": { "$numberInt": "2" }, "b": { "$numberDouble": "4.5" } }
      - { "_id": 1, "a": { "$numberLong": "2" }, "b": { "$numberInt": "2" } }
      - { "_id": 2, "a": { "$numberDecimal": "6.25" }, "b": { "$numberLong": "1" } }
      - { "_id": 3, "a": { "$numberDouble": "6.25" }, "b": null }
      - { "_id": 4, "a": null, "b": { "$numberInt": "3" } }
      - { "_id": 5, "a": { "$numberDouble": "6.25" } }
      - { "_id": 6, "b": { "$numberLong": "3" } }
    strings:
      - { "_id": 0, "a": "abc", "b": "def" }
      - { "_id": 1, "a": "xyz", "b": "xyz" }
      - { "_id": 2, "a": "xyz", "b": "abc" }
      - { "_id": 3, "a": "", "b": null }
      - { "_id": 4, "a": null, "b": "abc" }
      - { "_id": 5, "a": "abc" }
      - { "_id": 6, "b": "" }
    bools:
      - { "_id": 0, "a": false, "b": true }
      - { "_id": 1, "a": true, "b": true }
      - { "_id": 2, "a": true, "b": false }
      - { "_id": 3, "a": false, "b": null }
      - { "_id": 4, "a": null, "b": true }
      - { "_id": 5, "a": false }
      - { "_id": 6, "b": true }
    dates:
      - { "_id": 0, "a": { "$date": { "$numberLong": "253402300799999" } }, "b": { "$date": { "$numberLong": "253402399999999" } } }
      - { "_id": 1, "a": { "$date": { "$numberLong": "253402300799999" } }, "b": { "$date": { "$numberLong": "253402300799999" } } }
      - { "_id": 2, "a": { "$date": { "$numberLong": "253402300799999" } }, "b": { "$date": { "$numberLong": "253402300000000" } } }
      - { "_id": 3, "a": { "$date": { "$numberLong": "253402300799999" } }, "b": null }
      - { "_id": 4, "a": null, "b": { "$date": { "$numberLong": "253402300799999" } } }
      - { "_id": 5, "a": { "$date": { "$numberLong": "253402300799999" } } }
      - { "_id": 6, "b": { "$date": { "$numberLong": "253402300799999" } } }
    nullAndMissing:
      - { "_id": 0, "a": null, "b": null }
      - { "_id": 1, "a": null }
      - { "_id": 2, "b": null }
      - { "_id": 3 }
    betweenNumeric:
      - { "_id": 0, "a": { "$numberInt": "2" }, "b": { "$numberLong": "1" }, "c": { "$numberDouble": "3.1" } }
      - { "_id": 1, "a": { "$numberInt": "1" }, "b": { "$numberLong": "1" }, "c": { "$numberDecimal": "3.1" } }
      - { "_id": 2, "a": { "$numberInt": "3" }, "b": { "$numberLong": "1" }, "c": { "$numberInt": "3" } }
      - { "_id": 3, "a": { "$numberInt": "0" }, "b": { "$numberLong": "1" }, "c": { "$numberInt": "3" } }
      - { "_id": 4, "a": { "$numberInt": "4" }, "b": { "$numberLong": "1" }, "c": { "$numberInt": "3" } }
      - { "_id": 5, "a": null, "b": { "$numberLong": "1" }, "c": { "$numberInt": "3" } }
      - { "_id": 6, "a": { "$numberLong": "2" }, "b": null, "c": { "$numberInt": "3" } }
      - { "_id": 7, "a": { "$numberLong": "2" }, "b": { "$numberLong": "1" }, "c": null }
      - { "_id": 8, "b": { "$numberLong": "1" }, "c": { "$numberInt": "3" } }
      - { "_id": 9, "a": { "$numberLong": "2" }, "c": { "$numberInt": "3" } }
      - { "_id": 10, "a": { "$numberLong": "2" }, "b": { "$numberInt": "1" } }
    betweenStrings:
      - { "_id": 0, "a": "y", "b": "x", "c": "z" }
      - { "_id": 1, "a": "x", "b": "x", "c": "z" }
      - { "_id": 2, "a": "z", "b": "x", "c": "z" }
      - { "_id": 3, "a": "w", "b": "x", "c": "z" }
      - { "_id": 4, "a": "~", "b": "x", "c": "z" }
      - { "_id": 5, "a": null, "b": "x", "c": "z" }
      - { "_id": 6, "a": "y", "b": null, "c": "z" }
      - { "_id": 7, "a": "y", "b": "x", "c": null }
      - { "_id": 8, "b": "x", "c": "z" }
      - { "_id": 9, "a": "y", "c": "z" }
      - { "_id": 10, "a": "y", "b": "x" }
    betweenDates:
      - { "_id": 0, "a": { "$date": { "$numberLong": "10" } }, "b": { "$date": { "$numberLong": "5" } }, "c": { "$date": { "$numberLong": "15" } } }
      - { "_id": 1, "a": { "$date": { "$numberLong": "5" } }, "b": { "$date": { "$numberLong": "5" } }, "c": { "$date": { "$numberLong": "15" } } }
      - { "_id": 2, "a": { "$date": { "$numberLong": "15" } }, "b": { "$date": { "$numberLong": "5" } }, "c": { "$date": { "$numberLong": "15" } } }
      - { "_id": 3, "a": { "$date": { "$numberLong": "0" } }, "b": { "$date": { "$numberLong": "5" } }, "c": { "$date": { "$numberLong": "15" } } }
      - { "_id": 4, "a": { "$date": { "$numberLong": "20" } }, "b": { "$date": { "$numberLong": "5" } }, "c": { "$date": { "$numberLong": "15" } } }
      - { "_id": 5, "a": null, "b": { "$date": { "$numberLong": "5" } }, "c": { "$date": { "$numberLong": "15" } } }
      - { "_id": 6, "a": { "$date": { "$numberLong": "10" } }, "b": null, "c": { "$date": { "$numberLong": "15" } } }
      - { "_id": 7, "a": { "$date": { "$numberLong": "10" } }, "b": { "$date": { "$numberLong": "5" } }, "c": null }
      - { "_id": 8, "b": { "$date": { "$numberLong": "5" } }, "c": { "$date": { "$numberLong": "15" } } }
      - { "_id": 9, "a": { "$date": { "$numberLong": "10" } }, "c": { "$date": { "$numberLong": "15" } } }
      - { "_id": 10, "a": { "$date": { "$numberLong": "10" } }, "b": { "$date": { "$numberLong": "5" } } }

catalog_schema:
  {
    "foo": {
      "numbers": {
        "bsonType": "object",
        'required': [ '_id', 'a', 'b' ],
        'additionalProperties': false,
        "properties": {
          "_id": {
            "bsonType": "int"
          },
          "a": {
            "anyOf": [
              { "bsonType": "int" },
              { "bsonType": "long" },
              { "bsonType": "double" },
              { "bsonType": "decimal" },
              { "bsonType": !!str "null" }
            ]
          },
          "b": {
            "anyOf": [
              { "bsonType": "int" },
              { "bsonType": "long" },
              { "bsonType": "double" },
              { "bsonType": "decimal" },
              { "bsonType": !!str "null" }
            ]
          }
        }
      },
      "strings": {
        "bsonType": "object",
        'required': [ '_id', 'a', 'b' ],
        'additionalProperties': false,
        "properties": {
          "_id": {
            "bsonType": "int"
          },
          "a": {
            "anyOf": [
              { "bsonType": "string" },
              { "bsonType": !!str "null" }
            ]
          },
          "b": {
            "anyOf": [
              { "bsonType": "string" },
              { "bsonType": !!str "null" }
            ]
          }
        }
      },
      "bools": {
        "bsonType": "object",
        'required': [ '_id', 'a', 'b' ],
        'additionalProperties': false,
        "properties": {
          "_id": {
            "bsonType": "int"
          },
          "a": {
            "anyOf": [
              { "bsonType": "bool" },
              { "bsonType": !!str "null" }
            ]
          },
          "b": {
            "anyOf": [
              { "bsonType": "bool" },
              { "bsonType": !!str "null" }
            ]
          }
        }
      },
      "dates": {
        "bsonType": "object",
        'required': [ '_id', 'a', 'b' ],
        'additionalProperties': false,
        "properties": {
          "_id": {
            "bsonType": "int"
          },
          "a": {
            "anyOf": [
              { "bsonType": "date" },
              { "bsonType": !!str "null" }
            ]
          },
          "b": {
            "anyOf": [
              { "bsonType": "date" },
              { "bsonType": !!str "null" }
            ]
          }
        }
      },
      "nullAndMissing": {
        "bsonType": "object",
        'required': [ '_id', 'a', 'b' ],
        'additionalProperties': false,
        "properties": {
          "_id": {
            "bsonType": "int"
          },
          "a": {
            "bsonType": !!str "null"
          },
          "b": {
            "bsonType": !!str "null"
          }
        }
      },
      "betweenNumeric": {
        "bsonType": "object",
        'required': [ '_id', 'a', 'b', 'c' ],
        'additionalProperties': false,
        "properties": {
          "_id": {
            "bsonType": "int"
          },
          "a": {
            "anyOf": [
              { "bsonType": "int" },
              { "bsonType": "long" },
              { "bsonType": "double" },
              { "bsonType": "decimal" },
              { "bsonType": !!str "null" }
            ]
          },
          "b": {
            "anyOf": [
              { "bsonType": "int" },
              { "bsonType": "long" },
              { "bsonType": "double" },
              { "bsonType": "decimal" },
              { "bsonType": !!str "null" }
            ]
          },
          "c": {
            "anyOf": [
              { "bsonType": "int" },
              { "bsonType": "long" },
              { "bsonType": "double" },
              { "bsonType": "decimal" },
              { "bsonType": !!str "null" }
            ]
          }
        }
      },
      "betweenStrings": {
        "bsonType": "object",
        'required': [ '_id', 'a', 'b', 'c' ],
        'additionalProperties': false,
        "properties": {
          "_id": {
            "bsonType": "int"
          },
          "a": {
            "anyOf": [
              { "bsonType": "string" },
              { "bsonType": !!str "null" }
            ]
          },
          "b": {
            "anyOf": [
              { "bsonType": "string" },
              { "bsonType": !!str "null" }
            ]
          },
          "c": {
            "anyOf": [
              { "bsonType": "string" },
              { "bsonType": !!str "null" }
            ]
          }
        }
      },
      "betweenDates": {
        "bsonType": "object",
        'required': [ '_id', 'a', 'b', 'c' ],
        'additionalProperties': false,
        "properties": {
          "_id": {
            "bsonType": "int"
          },
          "a": {
            "anyOf": [
              { "bsonType": "date" },
              { "bsonType": !!str "null" }
            ]
          },
          "b": {
            "anyOf": [
              { "bsonType": "date" },
              { "bsonType": !!str "null" }
            ]
          },
          "c": {
            "anyOf": [
              { "bsonType": "date" },
              { "bsonType": !!str "null" }
            ]
          }
        }
      }
    }
  }

tests:
  - description: correctness test for lt for numeric types
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a < b } FROM numbers AS numbers"
    translation_target_db: foo
    translation_target_coll: numbers
    translation:
      - {'$project': {'_id': 0, 'numbers': '$$ROOT'}}
      - {'$project': {'_id': 0, 'numbers': '$numbers'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$numbers.a', 'b': '$numbers.b', 'c': {"$sqlLt": [ "$numbers.a", "$numbers.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": { "$numberInt": "2" }, "b": { "$numberDouble": "4.5" }, "c": true } }
      - {'': { "a": { "$numberLong": "2" }, "b": { "$numberInt": "2" }, "c": false } }
      - {'': { "a": { "$numberDecimal": "6.25" }, "b": { "$numberLong": "1" }, "c": false } }
      - {'': { "a": { "$numberDouble": "6.25" }, "b": null, "c": null } }
      - {'': { "a": null, "b": { "$numberInt": "3" }, "c": null } }
      - {'': { "a": { "$numberDouble": "6.25" }, "c": null } }
      - {'': { "b": { "$numberLong": "3" }, "c": null } }

  - description: correctness test for lte for numeric types
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a <= b } FROM numbers AS numbers"
    translation_target_db: foo
    translation_target_coll: numbers
    translation:
      - {'$project': {'_id': 0, 'numbers': '$$ROOT'}}
      - {'$project': {'_id': 0, 'numbers': '$numbers'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$numbers.a', 'b': '$numbers.b', 'c': {"$sqlLte": [ "$numbers.a", "$numbers.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": { "$numberInt": "2" }, "b": { "$numberDouble": "4.5" }, "c": true } }
      - {'': { "a": { "$numberLong": "2" }, "b": { "$numberInt": "2" }, "c": true } }
      - {'': { "a": { "$numberDecimal": "6.25" }, "b": { "$numberLong": "1" }, "c": false } }
      - {'': { "a": { "$numberDouble": "6.25" }, "b": null, "c": null } }
      - {'': { "a": null, "b": { "$numberInt": "3" }, "c": null } }
      - {'': { "a": { "$numberDouble": "6.25" }, "c": null } }
      - {'': { "b": { "$numberLong": "3" }, "c": null } }

  - description: correctness test for neq for numeric types
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a <> b } FROM numbers AS numbers"
    translation_target_db: foo
    translation_target_coll: numbers
    translation:
      - {'$project': {'_id': 0, 'numbers': '$$ROOT'}}
      - {'$project': {'_id': 0, 'numbers': '$numbers'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$numbers.a', 'b': '$numbers.b', 'c': {"$sqlNe": [ "$numbers.a", "$numbers.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": { "$numberInt": "2" }, "b": { "$numberDouble": "4.5" }, "c": true } }
      - {'': { "a": { "$numberLong": "2" }, "b": { "$numberInt": "2" }, "c": false } }
      - {'': { "a": { "$numberDecimal": "6.25" }, "b": { "$numberLong": "1" }, "c": true } }
      - {'': { "a": { "$numberDouble": "6.25" }, "b": null, "c": null } }
      - {'': { "a": null, "b": { "$numberInt": "3" }, "c": null } }
      - {'': { "a": { "$numberDouble": "6.25" }, "c": null } }
      - {'': { "b": { "$numberLong": "3" }, "c": null } }

  - description: correctness test for eq for numeric types
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a = b } FROM numbers AS numbers"
    translation_target_db: foo
    translation_target_coll: numbers
    translation:
      - {'$project': {'_id': 0, 'numbers': '$$ROOT'}}
      - {'$project': {'_id': 0, 'numbers': '$numbers'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$numbers.a', 'b': '$numbers.b', 'c': {"$sqlEq": [ "$numbers.a", "$numbers.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": { "$numberInt": "2" }, "b": { "$numberDouble": "4.5" }, "c": false } }
      - {'': { "a": { "$numberLong": "2" }, "b": { "$numberInt": "2" }, "c": true } }
      - {'': { "a": { "$numberDecimal": "6.25" }, "b": { "$numberLong": "1" }, "c": false } }
      - {'': { "a": { "$numberDouble": "6.25" }, "b": null, "c": null } }
      - {'': { "a": null, "b": { "$numberInt": "3" }, "c": null } }
      - {'': { "a": { "$numberDouble": "6.25" }, "c": null } }
      - {'': { "b": { "$numberLong": "3" }, "c": null } }

  - description: correctness test for gt for numeric types
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a > b } FROM numbers AS numbers"
    translation_target_db: foo
    translation_target_coll: numbers
    translation:
      - {'$project': {'_id': 0, 'numbers': '$$ROOT'}}
      - {'$project': {'_id': 0, 'numbers': '$numbers'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$numbers.a', 'b': '$numbers.b', 'c': {"$sqlGt": [ "$numbers.a", "$numbers.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": { "$numberInt": "2" }, "b": { "$numberDouble": "4.5" }, "c": false } }
      - {'': { "a": { "$numberLong": "2" }, "b": { "$numberInt": "2" }, "c": false } }
      - {'': { "a": { "$numberDecimal": "6.25" }, "b": { "$numberLong": "1" }, "c": true } }
      - {'': { "a": { "$numberDouble": "6.25" }, "b": null, "c": null } }
      - {'': { "a": null, "b": { "$numberInt": "3" }, "c": null } }
      - {'': { "a": { "$numberDouble": "6.25" }, "c": null } }
      - {'': { "b": { "$numberLong": "3" }, "c": null } }

  - description: correctness test for gte for numeric types
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a >= b } FROM numbers AS numbers"
    translation_target_db: foo
    translation_target_coll: numbers
    translation:
      - {'$project': {'_id': 0, 'numbers': '$$ROOT'}}
      - {'$project': {'_id': 0, 'numbers': '$numbers'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$numbers.a', 'b': '$numbers.b', 'c': {"$sqlGte": [ "$numbers.a", "$numbers.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": { "$numberInt": "2" }, "b": { "$numberDouble": "4.5" }, "c": false } }
      - {'': { "a": { "$numberLong": "2" }, "b": { "$numberInt": "2" }, "c": true } }
      - {'': { "a": { "$numberDecimal": "6.25" }, "b": { "$numberLong": "1" }, "c": true } }
      - {'': { "a": { "$numberDouble": "6.25" }, "b": null, "c": null } }
      - {'': { "a": null, "b": { "$numberInt": "3" }, "c": null } }
      - {'': { "a": { "$numberDouble": "6.25" }, "c": null } }
      - {'': { "b": { "$numberLong": "3" }, "c": null } }

  - description: correctness test for lt for strings
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a < b } FROM strings AS strings"
    translation_target_db: foo
    translation_target_coll: strings
    translation:
      - {'$project': {'_id': 0, 'strings': '$$ROOT'}}
      - {'$project': {'_id': 0, 'strings': '$strings'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$strings.a', 'b': '$strings.b', 'c': {"$sqlLt": [ "$strings.a", "$strings.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": "abc", "b": "def", "c": true } }
      - {'': { "a": "xyz", "b": "xyz", "c": false } }
      - {'': { "a": "xyz", "b": "abc", "c": false } }
      - {'': { "a": "", "b": null, "c": null } }
      - {'': { "a": null, "b": "abc", "c": null } }
      - {'': { "a": "abc", "c": null } }
      - {'': { "b": "", "c": null } }

  - description: correctness test for lte for strings
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a <= b } FROM strings AS strings"
    translation_target_db: foo
    translation_target_coll: strings
    translation:
      - {'$project': {'_id': 0, 'strings': '$$ROOT'}}
      - {'$project': {'_id': 0, 'strings': '$strings'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$strings.a', 'b': '$strings.b', 'c': {"$sqlLte": [ "$strings.a", "$strings.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": "abc", "b": "def", "c": true } }
      - {'': { "a": "xyz", "b": "xyz", "c": true } }
      - {'': { "a": "xyz", "b": "abc", "c": false } }
      - {'': { "a": "", "b": null, "c": null } }
      - {'': { "a": null, "b": "abc", "c": null } }
      - {'': { "a": "abc", "c": null } }
      - {'': { "b": "", "c": null } }

  - description: correctness test for neq for strings
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a <> b } FROM strings AS strings"
    translation_target_db: foo
    translation_target_coll: strings
    translation:
      - {'$project': {'_id': 0, 'strings': '$$ROOT'}}
      - {'$project': {'_id': 0, 'strings': '$strings'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$strings.a', 'b': '$strings.b', 'c': {"$sqlNe": [ "$strings.a", "$strings.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": "abc", "b": "def", "c": true } }
      - {'': { "a": "xyz", "b": "xyz", "c": false } }
      - {'': { "a": "xyz", "b": "abc", "c": true } }
      - {'': { "a": "", "b": null, "c": null } }
      - {'': { "a": null, "b": "abc", "c": null } }
      - {'': { "a": "abc", "c": null } }
      - {'': { "b": "", "c": null } }

  - description: correctness test for eq for strings
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a = b } FROM strings AS strings"
    translation_target_db: foo
    translation_target_coll: strings
    translation:
      - {'$project': {'_id': 0, 'strings': '$$ROOT'}}
      - {'$project': {'_id': 0, 'strings': '$strings'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$strings.a', 'b': '$strings.b', 'c': {"$sqlEq": [ "$strings.a", "$strings.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": "abc", "b": "def", "c": false } }
      - {'': { "a": "xyz", "b": "xyz", "c": true } }
      - {'': { "a": "xyz", "b": "abc", "c": false } }
      - {'': { "a": "", "b": null, "c": null } }
      - {'': { "a": null, "b": "abc", "c": null } }
      - {'': { "a": "abc", "c": null } }
      - {'': { "b": "", "c": null } }

  - description: correctness test for gt for strings
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a > b } FROM strings AS strings"
    translation_target_db: foo
    translation_target_coll: strings
    translation:
      - {'$project': {'_id': 0, 'strings': '$$ROOT'}}
      - {'$project': {'_id': 0, 'strings': '$strings'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$strings.a', 'b': '$strings.b', 'c': {"$sqlGt": [ "$strings.a", "$strings.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": "abc", "b": "def", "c": false } }
      - {'': { "a": "xyz", "b": "xyz", "c": false } }
      - {'': { "a": "xyz", "b": "abc", "c": true } }
      - {'': { "a": "", "b": null, "c": null } }
      - {'': { "a": null, "b": "abc", "c": null } }
      - {'': { "a": "abc", "c": null } }
      - {'': { "b": "", "c": null } }

  - description: correctness test for gte for strings
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a >= b } FROM strings AS strings"
    translation_target_db: foo
    translation_target_coll: strings
    translation:
      - {'$project': {'_id': 0, 'strings': '$$ROOT'}}
      - {'$project': {'_id': 0, 'strings': '$strings'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$strings.a', 'b': '$strings.b', 'c': {"$sqlGte": [ "$strings.a", "$strings.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": "abc", "b": "def", "c": false } }
      - {'': { "a": "xyz", "b": "xyz", "c": true } }
      - {'': { "a": "xyz", "b": "abc", "c": true } }
      - {'': { "a": "", "b": null, "c": null } }
      - {'': { "a": null, "b": "abc", "c": null } }
      - {'': { "a": "abc", "c": null } }
      - {'': { "b": "", "c": null } }

  - description: correctness test for lt for bools
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a < b } FROM bools AS bools"
    translation_target_db: foo
    translation_target_coll: bools
    translation:
      - {'$project': {'_id': 0, 'bools': '$$ROOT'}}
      - {'$project': {'_id': 0, 'bools': '$bools'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$bools.a', 'b': '$bools.b', 'c': {"$sqlLt": [ "$bools.a", "$bools.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": false, "b": true, "c": true } }
      - {'': { "a": true, "b": true, "c": false } }
      - {'': { "a": true, "b": false, "c": false } }
      - {'': { "a": false, "b": null, "c": null } }
      - {'': { "a": null, "b": true, "c": null } }
      - {'': { "a": false, "c": null } }
      - {'': { "b": true, "c": null } }

  - description: correctness test for lte for bools
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a <= b } FROM bools AS bools"
    translation_target_db: foo
    translation_target_coll: bools
    translation:
      - {'$project': {'_id': 0, 'bools': '$$ROOT'}}
      - {'$project': {'_id': 0, 'bools': '$bools'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$bools.a', 'b': '$bools.b', 'c': {"$sqlLte": [ "$bools.a", "$bools.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": false, "b": true, "c": true } }
      - {'': { "a": true, "b": true, "c": true } }
      - {'': { "a": true, "b": false, "c": false } }
      - {'': { "a": false, "b": null, "c": null } }
      - {'': { "a": null, "b": true, "c": null } }
      - {'': { "a": false, "c": null } }
      - {'': { "b": true, "c": null } }

  - description: correctness test for neq for bools
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a <> b } FROM bools AS bools"
    translation_target_db: foo
    translation_target_coll: bools
    translation:
      - {'$project': {'_id': 0, 'bools': '$$ROOT'}}
      - {'$project': {'_id': 0, 'bools': '$bools'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$bools.a', 'b': '$bools.b', 'c': {"$sqlNe": [ "$bools.a", "$bools.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": false, "b": true, "c": true } }
      - {'': { "a": true, "b": true, "c": false } }
      - {'': { "a": true, "b": false, "c": true } }
      - {'': { "a": false, "b": null, "c": null } }
      - {'': { "a": null, "b": true, "c": null } }
      - {'': { "a": false, "c": null } }
      - {'': { "b": true, "c": null } }

  - description: correctness test for eq for bools
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a = b } FROM bools AS bools"
    translation_target_db: foo
    translation_target_coll: bools
    translation:
      - {'$project': {'_id': 0, 'bools': '$$ROOT'}}
      - {'$project': {'_id': 0, 'bools': '$bools'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$bools.a', 'b': '$bools.b', 'c': {"$sqlEq": [ "$bools.a", "$bools.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": false, "b": true, "c": false } }
      - {'': { "a": true, "b": true, "c": true } }
      - {'': { "a": true, "b": false, "c": false } }
      - {'': { "a": false, "b": null, "c": null } }
      - {'': { "a": null, "b": true, "c": null } }
      - {'': { "a": false, "c": null } }
      - {'': { "b": true, "c": null } }

  - description: correctness test for gt for bools
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a > b } FROM bools AS bools"
    translation_target_db: foo
    translation_target_coll: bools
    translation:
      - {'$project': {'_id': 0, 'bools': '$$ROOT'}}
      - {'$project': {'_id': 0, 'bools': '$bools'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$bools.a', 'b': '$bools.b', 'c': {"$sqlGt": [ "$bools.a", "$bools.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": false, "b": true, "c": false } }
      - {'': { "a": true, "b": true, "c": false } }
      - {'': { "a": true, "b": false, "c": true } }
      - {'': { "a": false, "b": null, "c": null } }
      - {'': { "a": null, "b": true, "c": null } }
      - {'': { "a": false, "c": null } }
      - {'': { "b": true, "c": null } }

  - description: correctness test for gte for bools
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a >= b } FROM bools AS bools"
    translation_target_db: foo
    translation_target_coll: bools
    translation:
      - {'$project': {'_id': 0, 'bools': '$$ROOT'}}
      - {'$project': {'_id': 0, 'bools': '$bools'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$bools.a', 'b': '$bools.b', 'c': {"$sqlGte": [ "$bools.a", "$bools.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": false, "b": true, "c": false } }
      - {'': { "a": true, "b": true, "c": true } }
      - {'': { "a": true, "b": false, "c": true } }
      - {'': { "a": false, "b": null, "c": null } }
      - {'': { "a": null, "b": true, "c": null } }
      - {'': { "a": false, "c": null } }
      - {'': { "b": true, "c": null } }

  - description: correctness test for lt for dates
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a < b } FROM dates AS dates"
    translation_target_db: foo
    translation_target_coll: dates
    translation:
      - {'$project': {'_id': 0, 'dates': '$$ROOT'}}
      - {'$project': {'_id': 0, 'dates': '$dates'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$dates.a', 'b': '$dates.b', 'c': {"$sqlLt": [ "$dates.a", "$dates.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "b": { "$date": { "$numberLong": "253402399999999" } }, "c": true } }
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "b": { "$date": { "$numberLong": "253402300799999" } }, "c": false } }
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "b": { "$date": { "$numberLong": "253402300000000" } }, "c": false } }
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "b": null, "c": null } }
      - {'': { "a": null, "b": { "$date": { "$numberLong": "253402300799999" } }, "c": null } }
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "c": null } }
      - {'': { "b": { "$date": { "$numberLong": "253402300799999" } }, "c": null } }

  - description: correctness test for lte for dates
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a <= b } FROM dates AS dates"
    translation_target_db: foo
    translation_target_coll: dates
    translation:
      - {'$project': {'_id': 0, 'dates': '$$ROOT'}}
      - {'$project': {'_id': 0, 'dates': '$dates'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$dates.a', 'b': '$dates.b', 'c': {"$sqlLte": [ "$dates.a", "$dates.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "b": { "$date": { "$numberLong": "253402399999999" } }, "c": true } }
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "b": { "$date": { "$numberLong": "253402300799999" } }, "c": true } }
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "b": { "$date": { "$numberLong": "253402300000000" } }, "c": false } }
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "b": null, "c": null } }
      - {'': { "a": null, "b": { "$date": { "$numberLong": "253402300799999" } }, "c": null } }
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "c": null } }
      - {'': { "b": { "$date": { "$numberLong": "253402300799999" } }, "c": null } }

  - description: correctness test for neq for dates
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a <> b } FROM dates AS dates"
    translation_target_db: foo
    translation_target_coll: dates
    translation:
      - {'$project': {'_id': 0, 'dates': '$$ROOT'}}
      - {'$project': {'_id': 0, 'dates': '$dates'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$dates.a', 'b': '$dates.b', 'c': {"$sqlNe": [ "$dates.a", "$dates.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "b": { "$date": { "$numberLong": "253402399999999" } }, "c": true } }
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "b": { "$date": { "$numberLong": "253402300799999" } }, "c": false } }
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "b": { "$date": { "$numberLong": "253402300000000" } }, "c": true } }
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "b": null, "c": null } }
      - {'': { "a": null, "b": { "$date": { "$numberLong": "253402300799999" } }, "c": null } }
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "c": null } }
      - {'': { "b": { "$date": { "$numberLong": "253402300799999" } }, "c": null } }

  - description: correctness test for eq for dates
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a = b } FROM dates AS dates"
    translation_target_db: foo
    translation_target_coll: dates
    translation:
      - {'$project': {'_id': 0, 'dates': '$$ROOT'}}
      - {'$project': {'_id': 0, 'dates': '$dates'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$dates.a', 'b': '$dates.b', 'c': {"$sqlEq": [ "$dates.a", "$dates.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "b": { "$date": { "$numberLong": "253402399999999" } }, "c": false } }
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "b": { "$date": { "$numberLong": "253402300799999" } }, "c": true } }
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "b": { "$date": { "$numberLong": "253402300000000" } }, "c": false } }
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "b": null, "c": null } }
      - {'': { "a": null, "b": { "$date": { "$numberLong": "253402300799999" } }, "c": null } }
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "c": null } }
      - {'': { "b": { "$date": { "$numberLong": "253402300799999" } }, "c": null } }

  - description: correctness test for gt for dates
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a > b } FROM dates AS dates"
    translation_target_db: foo
    translation_target_coll: dates
    translation:
      - {'$project': {'_id': 0, 'dates': '$$ROOT'}}
      - {'$project': {'_id': 0, 'dates': '$dates'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$dates.a', 'b': '$dates.b', 'c': {"$sqlGt": [ "$dates.a", "$dates.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "b": { "$date": { "$numberLong": "253402399999999" } }, "c": false } }
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "b": { "$date": { "$numberLong": "253402300799999" } }, "c": false } }
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "b": { "$date": { "$numberLong": "253402300000000" } }, "c": true } }
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "b": null, "c": null } }
      - {'': { "a": null, "b": { "$date": { "$numberLong": "253402300799999" } }, "c": null } }
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "c": null } }
      - {'': { "b": { "$date": { "$numberLong": "253402300799999" } }, "c": null } }

  - description: correctness test for gte for dates
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a >= b } FROM dates AS dates"
    translation_target_db: foo
    translation_target_coll: dates
    translation:
      - {'$project': {'_id': 0, 'dates': '$$ROOT'}}
      - {'$project': {'_id': 0, 'dates': '$dates'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$dates.a', 'b': '$dates.b', 'c': {"$sqlGte": [ "$dates.a", "$dates.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "b": { "$date": { "$numberLong": "253402399999999" } }, "c": false } }
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "b": { "$date": { "$numberLong": "253402300799999" } }, "c": true } }
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "b": { "$date": { "$numberLong": "253402300000000" } }, "c": true } }
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "b": null, "c": null } }
      - {'': { "a": null, "b": { "$date": { "$numberLong": "253402300799999" } }, "c": null } }
      - {'': { "a": { "$date": { "$numberLong": "253402300799999" } }, "c": null } }
      - {'': { "b": { "$date": { "$numberLong": "253402300799999" } }, "c": null } }


  - description: correctness test for lt for null and missing
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a < b } FROM nullAndMissing AS nullAndMissing"
    translation_target_db: foo
    translation_target_coll: nullAndMissing
    translation:
      - {'$project': {'_id': 0, 'nullAndMissing': '$$ROOT'}}
      - {'$project': {'_id': 0, 'nullAndMissing': '$nullAndMissing'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$nullAndMissing.a', 'b': '$nullAndMissing.b', 'c': {"$sqlLt": [ "$nullAndMissing.a", "$nullAndMissing.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": null, "b": null, "c": null } }
      - {'': { "a": null, "c": null } }
      - {'': { "b": null, "c": null } }
      - {'': { "c": null } }

  - description: correctness test for lte for null and missing
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a <= b } FROM nullAndMissing AS nullAndMissing"
    translation_target_db: foo
    translation_target_coll: nullAndMissing
    translation:
      - {'$project': {'_id': 0, 'nullAndMissing': '$$ROOT'}}
      - {'$project': {'_id': 0, 'nullAndMissing': '$nullAndMissing'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$nullAndMissing.a', 'b': '$nullAndMissing.b', 'c': {"$sqlLte": [ "$nullAndMissing.a", "$nullAndMissing.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": null, "b": null, "c": null } }
      - {'': { "a": null, "c": null } }
      - {'': { "b": null, "c": null } }
      - {'': { "c": null } }

  - description: correctness test for neq for null and missing
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a <> b } FROM nullAndMissing AS nullAndMissing"
    translation_target_db: foo
    translation_target_coll: nullAndMissing
    translation:
      - {'$project': {'_id': 0, 'nullAndMissing': '$$ROOT'}}
      - {'$project': {'_id': 0, 'nullAndMissing': '$nullAndMissing'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$nullAndMissing.a', 'b': '$nullAndMissing.b', 'c': {"$sqlNe": [ "$nullAndMissing.a", "$nullAndMissing.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": null, "b": null, "c": null } }
      - {'': { "a": null, "c": null } }
      - {'': { "b": null, "c": null } }
      - {'': { "c": null } }

  - description: correctness test for eq for null and missing
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a = b } FROM nullAndMissing AS nullAndMissing"
    translation_target_db: foo
    translation_target_coll: nullAndMissing
    translation:
      - {'$project': {'_id': 0, 'nullAndMissing': '$$ROOT'}}
      - {'$project': {'_id': 0, 'nullAndMissing': '$nullAndMissing'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$nullAndMissing.a', 'b': '$nullAndMissing.b', 'c': {"$sqlEq": [ "$nullAndMissing.a", "$nullAndMissing.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": null, "b": null, "c": null } }
      - {'': { "a": null, "c": null } }
      - {'': { "b": null, "c": null } }
      - {'': { "c": null } }

  - description: correctness test for gt for null and missing
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a > b } FROM nullAndMissing AS nullAndMissing"
    translation_target_db: foo
    translation_target_coll: nullAndMissing
    translation:
      - {'$project': {'_id': 0, 'nullAndMissing': '$$ROOT'}}
      - {'$project': {'_id': 0, 'nullAndMissing': '$nullAndMissing'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$nullAndMissing.a', 'b': '$nullAndMissing.b', 'c': {"$sqlGt": [ "$nullAndMissing.a", "$nullAndMissing.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": null, "b": null, "c": null } }
      - {'': { "a": null, "c": null } }
      - {'': { "b": null, "c": null } }
      - {'': { "c": null } }

  - description: correctness test for gte for null and missing
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': a >= b } FROM nullAndMissing AS nullAndMissing"
    translation_target_db: foo
    translation_target_coll: nullAndMissing
    translation:
      - {'$project': {'_id': 0, 'nullAndMissing': '$$ROOT'}}
      - {'$project': {'_id': 0, 'nullAndMissing': '$nullAndMissing'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$nullAndMissing.a', 'b': '$nullAndMissing.b', 'c': {"$sqlGte": [ "$nullAndMissing.a", "$nullAndMissing.b" ]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": null, "b": null, "c": null } }
      - {'': { "a": null, "c": null } }
      - {'': { "b": null, "c": null } }
      - {'': { "c": null } }

  - description: correctness test for BETWEEN for numeric types
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': c, 'r': a BETWEEN b AND c } FROM betweenNumeric AS betweenNumeric"
    translation_target_db: foo
    translation_target_coll: betweenNumeric
    translation:
      - {'$project': {'_id': 0, 'betweenNumeric': '$$ROOT'}}
      - {'$project': {'_id': 0, 'betweenNumeric': '$betweenNumeric'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$betweenNumeric.a', 'b': '$betweenNumeric.b', 'c': '$betweenNumeric.c', 'r': {'$sqlBetween': ["$betweenNumeric.a", "$betweenNumeric.b", "$betweenNumeric.c"]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": { "$numberInt": "2" }, "b": { "$numberLong": "1" }, "c": { "$numberDouble": "3.1" }, "r": true } }
      - {'': { "a": { "$numberInt": "1" }, "b": { "$numberLong": "1" }, "c": { "$numberDecimal": "3.1" }, "r": true } }
      - {'': { "a": { "$numberInt": "3" }, "b": { "$numberLong": "1" }, "c": { "$numberInt": "3" }, "r": true } }
      - {'': { "a": { "$numberInt": "0" }, "b": { "$numberLong": "1" }, "c": { "$numberInt": "3" }, "r": false } }
      - {'': { "a": { "$numberInt": "4" }, "b": { "$numberLong": "1" }, "c": { "$numberInt": "3" }, "r": false } }
      - {'': { "a": null, "b": { "$numberLong": "1" }, "c": { "$numberInt": "3" }, "r": null } }
      - {'': { "a": { "$numberLong": "2" }, "b": null, "c": { "$numberInt": "3" }, "r": null } }
      - {'': { "a": { "$numberLong": "2" }, "b": { "$numberLong": "1" }, "c": null, "r": null } }
      - {'': { "b": { "$numberLong": "1" }, "c": { "$numberInt": "3" }, "r": null } }
      - {'': { "a": { "$numberLong": "2" }, "c": { "$numberInt": "3" }, "r": null } }
      - {'': { "a": { "$numberLong": "2" }, "b": { "$numberInt": "1" }, "r": null } }

  - description: correctness test for BETWEEN for strings
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': c, 'r': a BETWEEN b AND c } FROM betweenStrings AS betweenStrings"
    translation_target_db: foo
    translation_target_coll: betweenStrings
    translation:
      - {'$project': {'_id': 0, 'betweenStrings': '$$ROOT'}}
      - {'$project': {'_id': 0, 'betweenStrings': '$betweenStrings'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$betweenStrings.a', 'b': '$betweenStrings.b', 'c': '$betweenStrings.c', 'r': {'$sqlBetween': ["$betweenStrings.a", "$betweenStrings.b", "$betweenStrings.c"]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": "y", "b": "x", "c": "z", "r": true } }
      - {'': { "a": "x", "b": "x", "c": "z", "r": true } }
      - {'': { "a": "z", "b": "x", "c": "z", "r": true } }
      - {'': { "a": "w", "b": "x", "c": "z", "r": false } }
      - {'': { "a": "~", "b": "x", "c": "z", "r": null } }
      - {'': { "a": null, "b": "x", "c": "z", "r": null } }
      - {'': { "a": "y", "b": null, "c": "z", "r": null } }
      - {'': { "a": "y", "b": "x", "c": null, "r": null } }
      - {'': { "b": "x", "c": "z", "r": null } }
      - {'': { "a": "y", "c": "z", "r": null } }
      - {'': { "a": "y", "b": "x", "r": null } }

  - description: correctness test for BETWEEN for dates
    current_db: foo
    query: "SELECT VALUE { 'a': a, 'b': b, 'c': c, 'r': a BETWEEN b AND c } FROM betweenDates AS betweenDates"
    translation_target_db: foo
    translation_target_coll: betweenDates
    translation:
      - {'$project': {'_id': 0, 'betweenDates': '$$ROOT'}}
      - {'$project': {'_id': 0, 'betweenDates': '$betweenDates'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$betweenDates.a', 'b': '$betweenDates.b', 'c': '$betweenDates.c', 'r': {'$sqlBetween': ["$betweenDates.a", "$betweenDates.b", "$betweenDates.c"]}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': { "a": { "$date": { "$numberLong": "10" } }, "b": { "$date": { "$numberLong": "5" } }, "c": { "$date": { "$numberLong": "15" } }, "r": true } }
      - {'': { "a": { "$date": { "$numberLong": "5" } }, "b": { "$date": { "$numberLong": "5" } }, "c": { "$date": { "$numberLong": "15" } }, "r": true } }
      - {'': { "a": { "$date": { "$numberLong": "15" } }, "b": { "$date": { "$numberLong": "5" } }, "c": { "$date": { "$numberLong": "15" } }, "r": true } }
      - {'': { "a": { "$date": { "$numberLong": "0" } }, "b": { "$date": { "$numberLong": "5" } }, "c": { "$date": { "$numberLong": "15" } }, "r": false } }
      - {'': { "a": { "$date": { "$numberLong": "20" } }, "b": { "$date": { "$numberLong": "5" } }, "c": { "$date": { "$numberLong": "15" } }, "r": false } }
      - {'': { "a": null, "b": { "$date": { "$numberLong": "5" } }, "c": { "$date": { "$numberLong": "15" } }, "r": null } }
      - {'': { "a": { "$date": { "$numberLong": "10" } }, "b": null, "c": { "$date": { "$numberLong": "15" } }, "r": null } }
      - {'': { "a": { "$date": { "$numberLong": "10" } }, "b": { "$date": { "$numberLong": "5" } }, "c": null, "r": null } }
      - {'': { "b": { "$date": { "$numberLong": "5" } }, "c": { "$date": { "$numberLong": "15" } }, "r": null } }
      - {'': { "a": { "$date": { "$numberLong": "10" } }, "c": { "$date": { "$numberLong": "15" } }, "r": null } }
      - {'': { "a": { "$date": { "$numberLong": "10" } }, "b": { "$date": { "$numberLong": "5" } }, "r": null } }

