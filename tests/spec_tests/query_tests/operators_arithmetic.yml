catalog_data:
  foo:
    unary:
      - { "_id": 0, "a": { "$numberInt": "1" } }
      - { "_id": 1, "a": { "$numberInt": "-1" } }
      - { "_id": 2, "a": { "$numberLong": "1" } }
      - { "_id": 3, "a": { "$numberLong": "-1" } }
      - { "_id": 4, "a": { "$numberDouble": "1" } }
      - { "_id": 5, "a": { "$numberDouble": "-1" } }
      - { "_id": 6, "a": { "$numberDecimal": "1" } }
      - { "_id": 7, "a": { "$numberDecimal": "-1" } }
      - { "_id": 8, "a": null }
      - { "_id": 9 }
    binary:
      - { "_id": 0, "a": { "$numberInt": "6" }, "b": { "$numberInt": "2" } }
      - { "_id": 1, "a": { "$numberInt": "6" }, "b": { "$numberLong": "2" } }
      - { "_id": 2, "a": { "$numberInt": "6" }, "b": { "$numberDouble": "2" } }
      - { "_id": 3, "a": { "$numberInt": "6" }, "b": { "$numberDecimal": "2" } }
      - { "_id": 4, "a": { "$numberInt": "6" }, "b": null }
      - { "_id": 5, "a": { "$numberInt": "6" } }
      - { "_id": 6, "a": { "$numberLong": "6" }, "b": { "$numberInt": "2" } }
      - { "_id": 7, "a": { "$numberLong": "6" }, "b": { "$numberLong": "2" } }
      - { "_id": 8, "a": { "$numberLong": "6" }, "b": { "$numberDouble": "2" } }
      - { "_id": 9, "a": { "$numberLong": "6" }, "b": { "$numberDecimal": "2" } }
      - { "_id": 10, "a": { "$numberLong": "6" }, "b": null }
      - { "_id": 11, "a": { "$numberLong": "6" } }
      - { "_id": 12, "a": { "$numberDouble": "6" }, "b": { "$numberInt": "2" } }
      - { "_id": 13, "a": { "$numberDouble": "6" }, "b": { "$numberLong": "2" } }
      - { "_id": 14, "a": { "$numberDouble": "6" }, "b": { "$numberDouble": "2" } }
      - { "_id": 15, "a": { "$numberDouble": "6" }, "b": { "$numberDecimal": "2" } }
      - { "_id": 16, "a": { "$numberDouble": "6" }, "b": null }
      - { "_id": 17, "a": { "$numberDouble": "6" } }
      - { "_id": 18, "a": { "$numberDecimal": "6" }, "b": { "$numberInt": "2" } }
      - { "_id": 19, "a": { "$numberDecimal": "6" }, "b": { "$numberLong": "2" } }
      - { "_id": 20, "a": { "$numberDecimal": "6" }, "b": { "$numberDouble": "2" } }
      - { "_id": 21, "a": { "$numberDecimal": "6" }, "b": { "$numberDecimal": "2" } }
      - { "_id": 22, "a": { "$numberDecimal": "6" }, "b": null }
      - { "_id": 23, "a": { "$numberDecimal": "6" } }
      - { "_id": 24, "a": null, "b": { "$numberInt": "2" } }
      - { "_id": 25, "a": null, "b": { "$numberLong": "2" } }
      - { "_id": 26, "a": null, "b": { "$numberDouble": "2" } }
      - { "_id": 27, "a": null, "b": { "$numberDecimal": "2" } }
      - { "_id": 28, "a": null, "b": null }
      - { "_id": 29, "a": null }
      - { "_id": 30, "b": { "$numberInt": "2" } }
      - { "_id": 31, "b": { "$numberLong": "2" } }
      - { "_id": 32, "b": { "$numberDouble": "2" } }
      - { "_id": 33, "b": { "$numberDecimal": "2" } }
      - { "_id": 34, "b": null }
      - { "_id": 35 }
    integer_division:
      - { "_id": 1, "a": { "$numberInt": "5" }, "b": { "$numberInt": "2" } }
      - { "_id": 2, "a": { "$numberInt": "5" }, "b": { "$numberLong": "2" } }
      - { "_id": 3, "a": { "$numberLong": "5" }, "b": { "$numberInt": "2" } }
      - { "_id": 4, "a": { "$numberLong": "5" }, "b": { "$numberLong": "2" } }

catalog_schema:
  {
    "foo": {
      "unary": {
        "bsonType": "object",
        "properties": {
          "_id": {
            "bsonType": "int"
          },
          "a": {
            "anyOf": [
              { "bsonType": "int" },
              { "bsonType": "long" },
              { "bsonType": "double" },
              { "bsonType": "decimal" },
              { "bsonType": "null" }
            ]
          }
        }
      },
      "binary": {
        "bsonType": "object",
        "properties": {
          "_id": {
            "bsonType": "int"
          },
          "a": {
            "anyOf": [
              { "bsonType": "int" },
              { "bsonType": "long" },
              { "bsonType": "double" },
              { "bsonType": "decimal" },
              { "bsonType": "null" }
            ]
          },
          "b": {
            "anyOf": [
              { "bsonType": "int" },
              { "bsonType": "long" },
              { "bsonType": "double" },
              { "bsonType": "decimal" },
              { "bsonType": "null" }
            ]
          }
        }
      }
    }
  }

tests:
  - description: Unary plus correctness tests
    current_db: foo
    query: "SELECT VALUE {'a': a, '+a': +a} FROM unary AS unary"
    translation_target_db: foo
    translation_target_coll: unary
    translation:
      - {'$project': {'_id': 0, 'unary': '$$ROOT'}}
      - {'$project': {'_id': 0, 'unary': '$unary'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$unary.a', '+a': '$unary.a'}}}
    result:
      - {'__bot': {'a': {'$numberInt': '1'}, '+a': {'$numberInt': '1'}}}
      - {'__bot': {'a': {'$numberInt': '-1'}, '+a': {'$numberInt': '-1'}}}
      - {'__bot': {'a': {'$numberLong': '1'}, '+a': {'$numberLong': '1'}}}
      - {'__bot': {'a': {'$numberLong': '-1'}, '+a': {'$numberLong': '-1'}}}
      - {'__bot': {'a': {'$numberDouble': '1'}, '+a': {'$numberDouble': '1'}}}
      - {'__bot': {'a': {'$numberDouble': '-1'}, '+a': {'$numberDouble': '-1'}}}
      - {'__bot': {'a': {'$numberDecimal': '1'}, '+a': {'$numberDecimal': '1'}}}
      - {'__bot': {'a': {'$numberDecimal': '-1'}, '+a': {'$numberDecimal': '-1'}}}
      - {'__bot': {'a': null, '+a': null}}
      - {'__bot': {'+a': null}}

  - description: Unary minus correctness tests
    current_db: foo
    query: "SELECT VALUE {'a': a, '-a': -a} FROM unary AS unary"
    translation_target_db: foo
    translation_target_coll: unary
    translation:
      - {'$project': {'_id': 0, 'unary': '$$ROOT'}}
      - {'$project': {'_id': 0, 'unary': '$unary'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$unary.a', '-a': {'$multiply': [{'$literal': -1}, '$unary.a']}}}}
    result:
      - {'__bot': {'a': {'$numberInt': '1'}, '-a': {'$numberInt': '-1'}}}
      - {'__bot': {'a': {'$numberInt': '-1'}, '-a': {'$numberInt': '1'}}}
      - {'__bot': {'a': {'$numberLong': '1'}, '-a': {'$numberLong': '-1'}}}
      - {'__bot': {'a': {'$numberLong': '-1'}, '-a': {'$numberLong': '1'}}}
      - {'__bot': {'a': {'$numberDouble': '1'}, '-a': {'$numberDouble': '-1'}}}
      - {'__bot': {'a': {'$numberDouble': '-1'}, '-a': {'$numberDouble': '1'}}}
      - {'__bot': {'a': {'$numberDecimal': '1'}, '-a': {'$numberDecimal': '-1'}}}
      - {'__bot': {'a': {'$numberDecimal': '-1'}, '-a': {'$numberDecimal': '1'}}}
      - {'__bot': {'a': null, '-a': null}}
      - {'__bot': {'-a': null}}

  - description: Addition correctness tests
    current_db: foo
    query: "SELECT VALUE {'a': a, 'b': b, 'a+b': a + b} FROM binary AS binary"
    translation_target_db: foo
    translation_target_coll: binary
    translation:
      - {'$project': {'_id': 0, 'binary': '$$ROOT'}}
      - {'$project': {'_id': 0, 'binary': '$binary'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$binary.a', 'b': '$binary.b', 'a+b': {'$add': ['$binary.a', '$binary.b']}}}}
    result:
      - {'__bot': {'a': {'$numberInt': '6'}, 'b': {'$numberInt': '2'}, 'a+b': {'$numberInt': '8'}}}
      - {'__bot': {'a': {'$numberInt': '6'}, 'b': {'$numberLong': '2'}, 'a+b': {'$numberLong': '8'}}}
      - {'__bot': {'a': {'$numberInt': '6'}, 'b': {'$numberDouble': '2'}, 'a+b': {'$numberDouble': '8'}}}
      - {'__bot': {'a': {'$numberInt': '6'}, 'b': {'$numberDecimal': '2'}, 'a+b': {'$numberDecimal': '8'}}}
      - {'__bot': {'a': {'$numberInt': '6'}, 'b': null, 'a+b': null}}
      - {'__bot': {'a': {'$numberInt': '6'}, 'a+b': null}}
      - {'__bot': {'a': {'$numberLong': '6'}, 'b': {'$numberInt': '2'}, 'a+b': {'$numberLong': '8'}}}
      - {'__bot': {'a': {'$numberLong': '6'}, 'b': {'$numberLong': '2'}, 'a+b': {'$numberLong': '8'}}}
      - {'__bot': {'a': {'$numberLong': '6'}, 'b': {'$numberDouble': '2'}, 'a+b': {'$numberDouble': '8'}}}
      - {'__bot': {'a': {'$numberLong': '6'}, 'b': {'$numberDecimal': '2'}, 'a+b': {'$numberDecimal': '8'}}}
      - {'__bot': {'a': {'$numberLong': '6'}, 'b': null, 'a+b': null}}
      - {'__bot': {'a': {'$numberLong': '6'}, 'a+b': null}}
      - {'__bot': {'a': {'$numberDouble': '6'}, 'b': {'$numberInt': '2'}, 'a+b': {'$numberDouble': '8'}}}
      - {'__bot': {'a': {'$numberDouble': '6'}, 'b': {'$numberLong': '2'}, 'a+b': {'$numberDouble': '8'}}}
      - {'__bot': {'a': {'$numberDouble': '6'}, 'b': {'$numberDouble': '2'}, 'a+b': {'$numberDouble': '8'}}}
      - {'__bot': {'a': {'$numberDouble': '6'}, 'b': {'$numberDecimal': '2'}, 'a+b': {'$numberDecimal': '8'}}}
      - {'__bot': {'a': {'$numberDouble': '6'}, 'b': null, 'a+b': null}}
      - {'__bot': {'a': {'$numberDouble': '6'}, 'a+b': null}}
      - {'__bot': {'a': {'$numberDecimal': '6'}, 'b': {'$numberInt': '2'}, 'a+b': {'$numberDecimal': '8'}}}
      - {'__bot': {'a': {'$numberDecimal': '6'}, 'b': {'$numberLong': '2'}, 'a+b': {'$numberDecimal': '8'}}}
      - {'__bot': {'a': {'$numberDecimal': '6'}, 'b': {'$numberDouble': '2'}, 'a+b': {'$numberDecimal': '8'}}}
      - {'__bot': {'a': {'$numberDecimal': '6'}, 'b': {'$numberDecimal': '2'}, 'a+b': {'$numberDecimal': '8'}}}
      - {'__bot': {'a': {'$numberDecimal': '6'}, 'b': null, 'a+b': null}}
      - {'__bot': {'a': {'$numberDecimal': '6'}, 'a+b': null}}
      - {'__bot': {'a': null, 'b': {'$numberInt': '2'}, 'a+b': null}}
      - {'__bot': {'a': null, 'b': {'$numberLong': '2'}, 'a+b': null}}
      - {'__bot': {'a': null, 'b': {'$numberDouble': '2'}, 'a+b': null}}
      - {'__bot': {'a': null, 'b': {'$numberDecimal': '2'}, 'a+b': null}}
      - {'__bot': {'a': null, 'b': null, 'a+b': null}}
      - {'__bot': {'a': null, 'a+b': null}}
      - {'__bot': {'b': {'$numberInt': '2'}, 'a+b': null}}
      - {'__bot': {'b': {'$numberLong': '2'}, 'a+b': null}}
      - {'__bot': {'b': {'$numberDouble': '2'}, 'a+b': null}}
      - {'__bot': {'b': {'$numberDecimal': '2'}, 'a+b': null}}
      - {'__bot': {'b': null, 'a+b': null}}
      - {'__bot': {'a+b': null}}

  - description: Subtraction correctness tests
    current_db: foo
    query: "SELECT VALUE {'a': a, 'b': b, 'a-b': a - b} FROM binary AS binary"
    translation_target_db: foo
    translation_target_coll: binary
    translation:
      - {'$project': {'_id': 0, 'binary': '$$ROOT'}}
      - {'$project': {'_id': 0, 'binary': '$binary'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$binary.a', 'b': '$binary.b', 'a-b': {'$subtract': ['$binary.a', '$binary.b']}}}}
    result:
      - {'__bot': {'a': {'$numberInt': '6'}, 'b': {'$numberInt': '2'}, 'a-b': {'$numberInt': '4'}}}
      - {'__bot': {'a': {'$numberInt': '6'}, 'b': {'$numberLong': '2'}, 'a-b': {'$numberLong': '4'}}}
      - {'__bot': {'a': {'$numberInt': '6'}, 'b': {'$numberDouble': '2'}, 'a-b': {'$numberDouble': '4'}}}
      - {'__bot': {'a': {'$numberInt': '6'}, 'b': {'$numberDecimal': '2'}, 'a-b': {'$numberDecimal': '4'}}}
      - {'__bot': {'a': {'$numberInt': '6'}, 'b': null, 'a-b': null}}
      - {'__bot': {'a': {'$numberInt': '6'}, 'a-b': null}}
      - {'__bot': {'a': {'$numberLong': '6'}, 'b': {'$numberInt': '2'}, 'a-b': {'$numberLong': '4'}}}
      - {'__bot': {'a': {'$numberLong': '6'}, 'b': {'$numberLong': '2'}, 'a-b': {'$numberLong': '4'}}}
      - {'__bot': {'a': {'$numberLong': '6'}, 'b': {'$numberDouble': '2'}, 'a-b': {'$numberDouble': '4'}}}
      - {'__bot': {'a': {'$numberLong': '6'}, 'b': {'$numberDecimal': '2'}, 'a-b': {'$numberDecimal': '4'}}}
      - {'__bot': {'a': {'$numberLong': '6'}, 'b': null, 'a-b': null}}
      - {'__bot': {'a': {'$numberLong': '6'}, 'a-b': null}}
      - {'__bot': {'a': {'$numberDouble': '6'}, 'b': {'$numberInt': '2'}, 'a-b': {'$numberDouble': '4'}}}
      - {'__bot': {'a': {'$numberDouble': '6'}, 'b': {'$numberLong': '2'}, 'a-b': {'$numberDouble': '4'}}}
      - {'__bot': {'a': {'$numberDouble': '6'}, 'b': {'$numberDouble': '2'}, 'a-b': {'$numberDouble': '4'}}}
      - {'__bot': {'a': {'$numberDouble': '6'}, 'b': {'$numberDecimal': '2'}, 'a-b': {'$numberDecimal': '4'}}}
      - {'__bot': {'a': {'$numberDouble': '6'}, 'b': null, 'a-b': null}}
      - {'__bot': {'a': {'$numberDouble': '6'}, 'a-b': null}}
      - {'__bot': {'a': {'$numberDecimal': '6'}, 'b': {'$numberInt': '2'}, 'a-b': {'$numberDecimal': '4'}}}
      - {'__bot': {'a': {'$numberDecimal': '6'}, 'b': {'$numberLong': '2'}, 'a-b': {'$numberDecimal': '4'}}}
      - {'__bot': {'a': {'$numberDecimal': '6'}, 'b': {'$numberDouble': '2'}, 'a-b': {'$numberDecimal': '4'}}}
      - {'__bot': {'a': {'$numberDecimal': '6'}, 'b': {'$numberDecimal': '2'}, 'a-b': {'$numberDecimal': '4'}}}
      - {'__bot': {'a': {'$numberDecimal': '6'}, 'b': null, 'a-b': null}}
      - {'__bot': {'a': {'$numberDecimal': '6'}, 'a-b': null}}
      - {'__bot': {'a': null, 'b': {'$numberInt': '2'}, 'a-b': null}}
      - {'__bot': {'a': null, 'b': {'$numberLong': '2'}, 'a-b': null}}
      - {'__bot': {'a': null, 'b': {'$numberDouble': '2'}, 'a-b': null}}
      - {'__bot': {'a': null, 'b': {'$numberDecimal': '2'}, 'a-b': null}}
      - {'__bot': {'a': null, 'b': null, 'a-b': null}}
      - {'__bot': {'a': null, 'a-b': null}}
      - {'__bot': {'b': {'$numberInt': '2'}, 'a-b': null}}
      - {'__bot': {'b': {'$numberLong': '2'}, 'a-b': null}}
      - {'__bot': {'b': {'$numberDouble': '2'}, 'a-b': null}}
      - {'__bot': {'b': {'$numberDecimal': '2'}, 'a-b': null}}
      - {'__bot': {'b': null, 'a-b': null}}
      - {'__bot': {'a-b': null}}

  - description: Multiplication correctness tests
    current_db: foo
    query: "SELECT VALUE {'a': a, 'b': b, 'a*b': a * b} FROM binary AS binary"
    translation_target_db: foo
    translation_target_coll: binary
    translation:
      - {'$project': {'_id': 0, 'binary': '$$ROOT'}}
      - {'$project': {'_id': 0, 'binary': '$binary'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$binary.a', 'b': '$binary.b', 'a*b': {'$multiply': ['$binary.a', '$binary.b']}}}}
    result:
      - {'__bot': {'a': {'$numberInt': '6'}, 'b': {'$numberInt': '2'}, 'a*b': {'$numberInt': '12'}}}
      - {'__bot': {'a': {'$numberInt': '6'}, 'b': {'$numberLong': '2'}, 'a*b': {'$numberLong': '12'}}}
      - {'__bot': {'a': {'$numberInt': '6'}, 'b': {'$numberDouble': '2'}, 'a*b': {'$numberDouble': '12'}}}
      - {'__bot': {'a': {'$numberInt': '6'}, 'b': {'$numberDecimal': '2'}, 'a*b': {'$numberDecimal': '12'}}}
      - {'__bot': {'a': {'$numberInt': '6'}, 'b': null, 'a*b': null}}
      - {'__bot': {'a': {'$numberInt': '6'}, 'a*b': null}}
      - {'__bot': {'a': {'$numberLong': '6'}, 'b': {'$numberInt': '2'}, 'a*b': {'$numberLong': '12'}}}
      - {'__bot': {'a': {'$numberLong': '6'}, 'b': {'$numberLong': '2'}, 'a*b': {'$numberLong': '12'}}}
      - {'__bot': {'a': {'$numberLong': '6'}, 'b': {'$numberDouble': '2'}, 'a*b': {'$numberDouble': '12'}}}
      - {'__bot': {'a': {'$numberLong': '6'}, 'b': {'$numberDecimal': '2'}, 'a*b': {'$numberDecimal': '12'}}}
      - {'__bot': {'a': {'$numberLong': '6'}, 'b': null, 'a*b': null}}
      - {'__bot': {'a': {'$numberLong': '6'}, 'a*b': null}}
      - {'__bot': {'a': {'$numberDouble': '6'}, 'b': {'$numberInt': '2'}, 'a*b': {'$numberDouble': '12'}}}
      - {'__bot': {'a': {'$numberDouble': '6'}, 'b': {'$numberLong': '2'}, 'a*b': {'$numberDouble': '12'}}}
      - {'__bot': {'a': {'$numberDouble': '6'}, 'b': {'$numberDouble': '2'}, 'a*b': {'$numberDouble': '12'}}}
      - {'__bot': {'a': {'$numberDouble': '6'}, 'b': {'$numberDecimal': '2'}, 'a*b': {'$numberDecimal': '12'}}}
      - {'__bot': {'a': {'$numberDouble': '6'}, 'b': null, 'a*b': null}}
      - {'__bot': {'a': {'$numberDouble': '6'}, 'a*b': null}}
      - {'__bot': {'a': {'$numberDecimal': '6'}, 'b': {'$numberInt': '2'}, 'a*b': {'$numberDecimal': '12'}}}
      - {'__bot': {'a': {'$numberDecimal': '6'}, 'b': {'$numberLong': '2'}, 'a*b': {'$numberDecimal': '12'}}}
      - {'__bot': {'a': {'$numberDecimal': '6'}, 'b': {'$numberDouble': '2'}, 'a*b': {'$numberDecimal': '12'}}}
      - {'__bot': {'a': {'$numberDecimal': '6'}, 'b': {'$numberDecimal': '2'}, 'a*b': {'$numberDecimal': '12'}}}
      - {'__bot': {'a': {'$numberDecimal': '6'}, 'b': null, 'a*b': null}}
      - {'__bot': {'a': {'$numberDecimal': '6'}, 'a*b': null}}
      - {'__bot': {'a': null, 'b': {'$numberInt': '2'}, 'a*b': null}}
      - {'__bot': {'a': null, 'b': {'$numberLong': '2'}, 'a*b': null}}
      - {'__bot': {'a': null, 'b': {'$numberDouble': '2'}, 'a*b': null}}
      - {'__bot': {'a': null, 'b': {'$numberDecimal': '2'}, 'a*b': null}}
      - {'__bot': {'a': null, 'b': null, 'a*b': null}}
      - {'__bot': {'a': null, 'a*b': null}}
      - {'__bot': {'b': {'$numberInt': '2'}, 'a*b': null}}
      - {'__bot': {'b': {'$numberLong': '2'}, 'a*b': null}}
      - {'__bot': {'b': {'$numberDouble': '2'}, 'a*b': null}}
      - {'__bot': {'b': {'$numberDecimal': '2'}, 'a*b': null}}
      - {'__bot': {'b': null, 'a*b': null}}
      - {'__bot': {'a*b': null}}

  - description: Division correctness tests
    current_db: foo
    query: "SELECT VALUE {'a': a, 'b': b, 'a/b': a / b} FROM binary AS binary"
    translation_target_db: foo
    translation_target_coll: binary
    translation:
      - {'$project': {'_id': 0, 'binary': '$$ROOT'}}
      - {'$project': {'_id': 0, 'binary': '$binary'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$binary.a', 'b': '$binary.b', 'a/b': {'$sqlDivide': {'dividend': '$binary.a', 'divisor': '$binary.b', 'onError': {'$literal': null}}}}}}
    result:
      - {'__bot': {'a': {'$numberInt': '6'}, 'b': {'$numberInt': '2'}, 'a/b': {'$numberInt': '3'}}}
      - {'__bot': {'a': {'$numberInt': '6'}, 'b': {'$numberLong': '2'}, 'a/b': {'$numberLong': '3'}}}
      - {'__bot': {'a': {'$numberInt': '6'}, 'b': {'$numberDouble': '2'}, 'a/b': {'$numberDouble': '3'}}}
      - {'__bot': {'a': {'$numberInt': '6'}, 'b': {'$numberDecimal': '2'}, 'a/b': {'$numberDecimal': '3'}}}
      - {'__bot': {'a': {'$numberInt': '6'}, 'b': null, 'a/b': null}}
      - {'__bot': {'a': {'$numberInt': '6'}, 'a/b': null}}
      - {'__bot': {'a': {'$numberLong': '6'}, 'b': {'$numberInt': '2'}, 'a/b': {'$numberLong': '3'}}}
      - {'__bot': {'a': {'$numberLong': '6'}, 'b': {'$numberLong': '2'}, 'a/b': {'$numberLong': '3'}}}
      - {'__bot': {'a': {'$numberLong': '6'}, 'b': {'$numberDouble': '2'}, 'a/b': {'$numberDouble': '3'}}}
      - {'__bot': {'a': {'$numberLong': '6'}, 'b': {'$numberDecimal': '2'}, 'a/b': {'$numberDecimal': '3'}}}
      - {'__bot': {'a': {'$numberLong': '6'}, 'b': null, 'a/b': null}}
      - {'__bot': {'a': {'$numberLong': '6'}, 'a/b': null}}
      - {'__bot': {'a': {'$numberDouble': '6'}, 'b': {'$numberInt': '2'}, 'a/b': {'$numberDouble': '3'}}}
      - {'__bot': {'a': {'$numberDouble': '6'}, 'b': {'$numberLong': '2'}, 'a/b': {'$numberDouble': '3'}}}
      - {'__bot': {'a': {'$numberDouble': '6'}, 'b': {'$numberDouble': '2'}, 'a/b': {'$numberDouble': '3'}}}
      - {'__bot': {'a': {'$numberDouble': '6'}, 'b': {'$numberDecimal': '2'}, 'a/b': {'$numberDecimal': '3'}}}
      - {'__bot': {'a': {'$numberDouble': '6'}, 'b': null, 'a/b': null}}
      - {'__bot': {'a': {'$numberDouble': '6'}, 'a/b': null}}
      - {'__bot': {'a': {'$numberDecimal': '6'}, 'b': {'$numberInt': '2'}, 'a/b': {'$numberDecimal': '3'}}}
      - {'__bot': {'a': {'$numberDecimal': '6'}, 'b': {'$numberLong': '2'}, 'a/b': {'$numberDecimal': '3'}}}
      - {'__bot': {'a': {'$numberDecimal': '6'}, 'b': {'$numberDouble': '2'}, 'a/b': {'$numberDecimal': '3'}}}
      - {'__bot': {'a': {'$numberDecimal': '6'}, 'b': {'$numberDecimal': '2'}, 'a/b': {'$numberDecimal': '3'}}}
      - {'__bot': {'a': {'$numberDecimal': '6'}, 'b': null, 'a/b': null}}
      - {'__bot': {'a': {'$numberDecimal': '6'}, 'a/b': null}}
      - {'__bot': {'a': null, 'b': {'$numberInt': '2'}, 'a/b': null}}
      - {'__bot': {'a': null, 'b': {'$numberLong': '2'}, 'a/b': null}}
      - {'__bot': {'a': null, 'b': {'$numberDouble': '2'}, 'a/b': null}}
      - {'__bot': {'a': null, 'b': {'$numberDecimal': '2'}, 'a/b': null}}
      - {'__bot': {'a': null, 'b': null, 'a/b': null}}
      - {'__bot': {'a': null, 'a/b': null}}
      - {'__bot': {'b': {'$numberInt': '2'}, 'a/b': null}}
      - {'__bot': {'b': {'$numberLong': '2'}, 'a/b': null}}
      - {'__bot': {'b': {'$numberDouble': '2'}, 'a/b': null}}
      - {'__bot': {'b': {'$numberDecimal': '2'}, 'a/b': null}}
      - {'__bot': {'b': null, 'a/b': null}}
      - {'__bot': {'a/b': null}}

  - description: Division by zero results in NULL
    current_db: foo
    query: "SELECT VALUE {'a': a, 'n': a / 0} FROM unary AS unary"
    translation_target_db: foo
    translation_target_coll: unary
    translation:
      - {'$project': {'_id': 0, 'unary': '$$ROOT'}}
      - {'$project': {'_id': 0, 'unary': '$unary'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$unary.a', 'n': {'$sqlDivide': {'dividend': '$unary.a', 'divisor': {'$literal': 0}, 'onError': {'$literal': null}}}}}}
    result:
      - {'__bot': {'a': {'$numberInt': '1'}, 'n': null}}
      - {'__bot': {'a': {'$numberInt': '-1'}, 'n': null}}
      - {'__bot': {'a': {'$numberLong': '1'}, 'n': null}}
      - {'__bot': {'a': {'$numberLong': '-1'}, 'n': null}}
      - {'__bot': {'a': {'$numberDouble': '1'}, 'n': null}}
      - {'__bot': {'a': {'$numberDouble': '-1'}, 'n': null}}
      - {'__bot': {'a': {'$numberDecimal': '1'}, 'n': null}}
      - {'__bot': {'a': {'$numberDecimal': '-1'}, 'n': null}}
      - {'__bot': {'a': null, 'n': null}}
      - {'__bot': {'n': null}}

  - description: Long and integer division with non-integer results are truncated
    current_db: foo
    query: "SELECT VALUE {'a': a, 'b': b, 'n': a / b} FROM integer_division AS i"
    translation_target_db: foo
    translation_target_coll: i
    translation:
      - {'$project': {'_id': 0, 'integer_division': '$$ROOT'}}
      - {'$project': {'_id': 0, 'i': '$integer_division'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$i.a', 'b': '$i.b', 'n': {'$sqlDivide': {'dividend': '$i.a', 'divisor': '$i.b', 'onError': {'$literal': null}}}}}}
    result:
      - {'__bot': {'a': {'$numberInt': '5'}, 'b': {'$numberInt': '2'}, 'n': {'$numberInt': '2'}}}
      - {'__bot': {'a': {'$numberInt': '5'}, 'b': {'$numberLong': '2'}, 'n': {'$numberLong': '2'}}}
      - {'__bot': {'a': {'$numberLong': '5'}, 'b': {'$numberInt': '2'}, 'n': {'$numberLong': '2'}}}
      - {'__bot': {'a': {'$numberLong': '5'}, 'b': {'$numberLong': '2'}, 'n': {'$numberLong': '2'}}}
