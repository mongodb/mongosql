catalog_environment:
  foo:
    unary:
      - { "_id": 0, "a": true }
      - { "_id": 1, "a": false }
      - { "_id": 2, "a": null }
      - { "_id": 3 }
    binary:
      - { "_id": 0, "a": true, "b": true }
      - { "_id": 1, "a": true, "b": false }
      - { "_id": 2, "a": true, "b": null }
      - { "_id": 3, "a": true }
      - { "_id": 4, "a": false, "b": true }
      - { "_id": 5, "a": false, "b": false }
      - { "_id": 6, "a": false, "b": null }
      - { "_id": 7, "a": false }
      - { "_id": 8, "a": null, "b": true }
      - { "_id": 9, "a": null, "b": false }
      - { "_id": 10, "a": null, "b": null }
      - { "_id": 11, "a": null }
      - { "_id": 12, "b": true }
      - { "_id": 13, "b": false }
      - { "_id": 14, "b": null }
      - { "_id": 15 }

schema_environment:
  {
    "foo": {
      "unary": {
        "$jsonSchema": {
          "bsonType": "object",
          "properties": {
            "_id": {
              "bsonType": "int"
            },
            "a": {
              "anyOf": [
                { "bsonType": "bool" },
                { "bsonType": "null" }
              ]
            }
          }
        }
      },
      "binary": {
        "$jsonSchema": {
          "bsonType": "object",
          "properties": {
            "_id": {
              "bsonType": "int"
            },
            "a": {
              "anyOf": [
                { "bsonType": "bool" },
                { "bsonType": "null" }
              ]
            },
            "b": {
              "anyOf": [
                { "bsonType": "bool" },
                { "bsonType": "null" }
              ]
            }
          }
        }
      }
    }
  }

tests:
  - description: NOT correctness test
    query: "SELECT VALUE { 'a': a, 'not_a': NOT a } FROM unary AS unary"
    translation_target_db: foo
    translation_target_coll: unary
    translation:
      - {'$project': {'_id': 0, 'unary': '$$ROOT'}}
      - {'$project': {'_id': 0, 'unary': '$unary'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$unary.a', 'not_a': {"$sqlNot": "$unary.a"}}}}
    result:
      - {'__bot': {"a": true, "not_a": false } }
      - {'__bot': {"a": false, "not_a": true } }
      - {'__bot': {"a": null, "not_a": null } }
      - {'__bot': {"not_a": null } }

  - description: AND correctness test
    query: "SELECT VALUE { 'a': a, 'b': b, 'a_and_b': a AND b } FROM binary AS binary"
    translation_target_db: foo
    translation_target_coll: binary
    translation:
      - {'$project': {'_id': 0, 'binary': '$$ROOT'}}
      - {'$project': {'_id': 0, 'binary': '$binary'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$binary.a', 'b': '$binary.b', 'a_and_b': {"$sqlAnd": ["$binary.a", "$binary.b"]}}}}
    result:
      - {'__bot': {"a": true, "b": true, "a_and_b": true } }
      - {'__bot': {"a": true, "b": false, "a_and_b": false } }
      - {'__bot': {"a": true, "b": null, "a_and_b": null } }
      - {'__bot': {"a": true, "a_and_b": null } }
      - {'__bot': {"a": false, "b": true, "a_and_b": false } }
      - {'__bot': {"a": false, "b": false, "a_and_b": false } }
      - {'__bot': {"a": false, "b": null, "a_and_b": false } }
      - {'__bot': {"a": false, "a_and_b": false } }
      - {'__bot': {"a": null, "b": true, "a_and_b": null } }
      - {'__bot': {"a": null, "b": false, "a_and_b": false } }
      - {'__bot': {"a": null, "b": null, "a_and_b": null } }
      - {'__bot': {"a": null, "a_and_b": null } }
      - {'__bot': {"b": true, "a_and_b": null } }
      - {'__bot': {"b": false, "a_and_b": false } }
      - {'__bot': {"b": null, "a_and_b": null } }
      - {'__bot': {"a_and_b": null } }

  - description: OR correctness test
    query: "SELECT VALUE { 'a': a, 'b': b, 'a_or_b': a OR b } FROM binary AS binary"
    translation_target_db: foo
    translation_target_coll: binary
    translation:
      - {'$project': {'_id': 0, 'binary': '$$ROOT'}}
      - {'$project': {'_id': 0, 'binary': '$binary'}}
      - {'$project': {'_id': 0, '__bot': {'a': '$binary.a', 'b': '$binary.b', 'a_or_b': {"$sqlOr": ["$$binary.a", "$$binary.b"]}}}}
    result:
      - {'__bot': {"a": true, "b": true, "a_or_b": true } }
      - {'__bot': {"a": true, "b": false, "a_or_b": true } }
      - {'__bot': {"a": true, "b": null, "a_or_b": true } }
      - {'__bot': {"a": true, "a_or_b": true } }
      - {'__bot': {"a": false, "b": true, "a_or_b": true } }
      - {'__bot': {"a": false, "b": false, "a_or_b": false } }
      - {'__bot': {"a": false, "b": null, "a_or_b": null } }
      - {'__bot': {"a": false, "a_or_b": null } }
      - {'__bot': {"a": null, "b": true, "a_or_b": true } }
      - {'__bot': {"a": null, "b": false, "a_or_b": null } }
      - {'__bot': {"a": null, "b": null, "a_or_b": null } }
      - {'__bot': {"a": null, "a_or_b": null } }
      - {'__bot': {"b": true, "a_or_b": true } }
      - {'__bot': {"b": false, "a_or_b": null } }
      - {'__bot': {"b": null, "a_or_b": null } }
      - {'__bot': {"a_or_b": null } }
