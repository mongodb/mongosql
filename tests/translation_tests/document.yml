tests:
  - description: multi-level field access from literal document is constant folded
    query: "SELECT VALUE {'c': {'a': {'b': {'c': 1}}}.a.b['c']} FROM [{}] AS _dual"
    skip_reason: "SQL-593"
    translation:
      - {'$documents': [{'$literal': {}}]}
      - {'$project': {'_id': 0, '_dual': '$$ROOT'}}
      - {'$project': {'_id': 0, '__bot': {'c': {'$literal': 1}}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'': {'c': 1}}

  - description: multi-level field access from ref-containing document
    query: "SELECT VALUE {'c': doc.a.b['c']} FROM [{'doc': {'a': {'b': {'c': 1}}}}] AS arr"
    translation:
      - {'$documents': [{'doc': {'a': {'b': {'c': {'$literal': 1}}}}}]}
      - {'$project': {'_id': 0, 'arr': '$$ROOT'}}
      - {'$project': {'_id': 0, '__bot': {'c': '$arr.doc.a.b.c'}}}
      - { '$replaceWith': { '$unsetField': { 'field': '__bot', 'input':
           { '$setField': { 'field': '' , 'input': '$$ROOT', 'value': '$__bot' }
        }}}}
    result:
      - {'__bot': {'c': 1}}
