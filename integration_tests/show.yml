#
# Data
#
data:
- archive_file: testdata/input/test1.bson.gz

# Schema

schema:
- db: test
  tables:
  - table: foo
    collection: test1
    columns:
    - Name: a
      MongoType: int
      SqlName: a1
      SqlType: int64
    - Name: b
      MongoType: string
      SqlName: b1
      SqlType: varchar
    - Name: c
      MongoType: int64
      SqlName: c1
      SqlType: int64
  - table: bar
    collection: test2
    columns:
      - Name: a
        MongoType: int
        SqlName: a
        SqlType: int64
      - Name: b
        MongoType: string
        SqlName: b
        SqlType: varchar
      - Name: c
        MongoType: int64
        SqlName: c
        SqlType: int64
- db: blah
  tables:
  - table: foo
    collection: foo
    columns:
    - Name: a
      MongoType: int
      SqlName: a
      SqlType: int64

#
# 3. Tests
#
testcases:
- sql: "SHOW COLUMNS FROM foo"
  expected_types: [varchar, varchar, varchar, varchar, varchar, varchar]
  expected:
    - ["a1", "int64", "YES", "", ~, ""]
    - ["b1", "varchar", "YES", "", ~, ""]
    - ["c1", "int64", "YES", "", ~, ""]
# - sql: "SHOW COLUMNS FROM foo LIKE 'b'" // NEEDS PARSER SUPPORT
#   expected_types: [varchar, varchar, varchar, varchar, varchar, varchar]
#   expected:
#     - ["b1", "varchar", "YES", "", "", ""]
# - sql: "SHOW COLUMNS FROM foo WHERE type = 'int'" // NEEDS PARSER SUPPORT
#   expected_types: [varchar, varchar, varchar, varchar, varchar, varchar]
#   expected:
#     - ["b1", "varchar", "YES", "", "", ""]
- sql: "SHOW COLUMNS FROM test.foo"
  expected_types: [varchar, varchar, varchar, varchar, varchar, varchar]
  expected:
    - ["a1", "int64", "YES", "", ~, ""]
    - ["b1", "varchar", "YES", "", ~, ""]
    - ["c1", "int64", "YES", "", ~, ""]
- sql: "SHOW COLUMNS FROM foo FROM test"
  expected_types: [varchar, varchar, varchar, varchar, varchar, varchar]
  expected:
    - ["a1", "int64", "YES", "", ~, ""]
    - ["b1", "varchar", "YES", "", ~, ""]
    - ["c1", "int64", "YES", "", ~, ""]
- sql: "SHOW COLUMNS IN foo IN test"
  expected_types: [varchar, varchar, varchar, varchar, varchar, varchar]
  expected:
    - ["a1", "int64", "YES", "", ~, ""]
    - ["b1", "varchar", "YES", "", ~, ""]
    - ["c1", "int64", "YES", "", ~, ""]
- sql: "SHOW FULL COLUMNS FROM foo"
  expected_types: [varchar, varchar, varchar, varchar, varchar, varchar, varchar, varchar, varchar]
  expected:
    - ["a1", "int64", "utf8_bin", "YES", "", ~, "", "select", "{ \"name\": \"a\" }"]
    - ["b1", "varchar", "utf8_bin", "YES", "", ~, "", "select", "{ \"name\": \"b\" }"]
    - ["c1", "int64", "utf8_bin", "YES", "", ~, "", "select", "{ \"name\": \"c\" }"]
- sql: "SHOW COLUMNS FROM test2.foo"
  expected_types: [varchar, varchar, varchar, varchar, varchar, varchar]
  expected: []
- sql: "SHOW TABLES"
  expected_types: [varchar]
  expected: 
    - ["bar"]
    - ["foo"]
- sql: "SHOW TABLES LIKE 'f%'"
  expected_types: [varchar]
  expected: 
    - ["foo"]
- sql: "SHOW TABLES WHERE Tables_in_test = 'foo'"
  expected_types: [varchar]
  expected: 
    - ["foo"]
- sql: "SHOW TABLES FROM test"
  expected_types: [varchar]
  expected: 
    - ["bar"]
    - ["foo"]
#- sql: "SHOW FULL TABLES" // NEEDS PARSER SUPPORT
#  expected_types: [varchar, varchar]
#  expected: 
#    - ["foo", "VIEW"]
#    - ["bar", "VIEW"]
- sql: "SHOW TABLES FROM nonono"
  expected_types: [varchar]
  expected: []
- sql: "SHOW DATABASES"
  expected_types: [varchar]
  expected: 
    - ["blah"]
    - ["information_schema"]
    - ["test"]
- sql: "SHOW DATABASES LIKE 'b%'"
  expected_types: [varchar]
  expected: 
    - ["blah"]
- sql: "SHOW DATABASES WHERE `Database` = 'test'"
  expected_types: [varchar]
  expected: 
    - ["test"]
#- sql: "SHOW SCHEMAS" // NEEDS PARSER SUPPORT
#  expected_types: [varchar]
#  expected: 
#    - ["test"]
#    - ["blah"]

- sql: "SHOW VARIABLES LIKE '%auto_incr%'"
  expected_types: [varchar, varchar]
  expected: 
    - ["auto_increment_increment", "1"]
    - ["auto_increment_offset", "1"]
- sql: "SHOW SESSION VARIABLES LIKE '%auto_incr%'"
  expected_types: [varchar, varchar]
  expected: 
    - ["auto_increment_increment", "1"]
    - ["auto_increment_offset", "1"]
- sql: "SHOW GLOBAL VARIABLES LIKE '%auto_incr%'"
  expected_types: [varchar, varchar]
  expected: 
    - ["auto_increment_increment", "1"]
    - ["auto_increment_offset", "1"]
- sql: "SHOW VARIABLES LIKE '%info%'"
  expected_types: [varchar, varchar]
  expected:
    - ["master_info_repository", "FILE"]
    - ["ndbinfo_database", "ndbinfo"]
    - ["ndbinfo_max_bytes", "0"]
    - ["ndbinfo_max_rows", "10"]
    - ["ndbinfo_offline", "0"]
    - ["ndbinfo_show_hidden", "0"]
    - ["ndbinfo_table_prefix", "ndb$"]
    - ["ndbinfo_version", ""]
    - ["relay_log_info_file", "relay-log.info"]
    - ["relay_log_info_repository", "FILE"]
    - ["sync_master_info", "10000"]
    - ["sync_relay_log_info", "10000"]
- sql: "SHOW GLOBAL VARIABLES WHERE Variable_name = 'autocommit'"
  expected_types: [varchar, varchar]
  expected: 
    - ["autocommit", "1"]
- sql: "SHOW STATUS LIKE '%stmt_create_collection%'"
  expected_types: [varchar, varchar]
  expected: 
    - ["Mysqlx_stmt_create_collection", "0"]
    - ["Mysqlx_stmt_create_collection_index", "0"]
- sql: "SHOW GLOBAL STATUS LIKE '%stmt_create_collection%'"
  expected_types: [varchar, varchar]
  expected: 
    - ["Mysqlx_stmt_create_collection", "0"]
    - ["Mysqlx_stmt_create_collection_index", "0"]
- sql: "SHOW SESSION STATUS LIKE '%stmt_create_collection%'"
  expected_types: [varchar, varchar]
  expected: 
    - ["Mysqlx_stmt_create_collection", "0"]
    - ["Mysqlx_stmt_create_collection_index", "0"]
- sql: "SHOW SESSION STATUS WHERE Variable_name = 'Uptime'"
  expected_types: [varchar, varchar]
  expected: 
    - ["Uptime", "0"]
- sql: "SHOW COLLATION LIKE '%sinhala%'"
  expected_types: [varchar, varchar, int, varchar, varchar, int]
  expected:
    - ["utf16_sinhala_ci", "utf16", 120, "No", "Yes", 8]
    - ["utf32_sinhala_ci", "utf32", 179, "No", "Yes", 8]
    - ["utf8_sinhala_ci", "utf8", 211, "No", "Yes", 8]
    - ["utf8mb4_sinhala_ci", "utf8mb4", 243, "No", "Yes", 8]
- sql: "SHOW CHARSET LIKE '%cp1%'"
  expected_types: [varchar, varchar, varchar, int]
  expected:
    - ["cp1250", "Windows Central European", "cp1250_general_ci", 1]
    - ["cp1251", "Windows Cyrillic", "cp1251_general_ci", 1]
    - ["cp1256", "Windows Arabic", "cp1256_general_ci", 1]
    - ["cp1257", "Windows Baltic", "cp1257_general_ci", 1]
- sql: "SHOW CHARSET LIKE 'eucjpms'"
  expected_types: [varchar, varchar, varchar, int]
  expected:
    - ["eucjpms", "UJIS for Windows Japanese", "eucjpms_japanese_ci", 3]
