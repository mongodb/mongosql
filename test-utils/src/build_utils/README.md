# Overview

The `build_utils/mod.rs` file contains the necessary funcitonality
to process test files in `.yml` format and create autogenerated tests.

It is used in conjunction with the build script in [e2e-tests](../../../e2e-tests/README.md).

## Functionality

Each test file path is tested to see if it contains a specific marker string.
Depending on the marker string, the proper test type will be identified, or
it will panic to signal an unidentified test type.

The file is then processed, with a header created for setup shared among all
tests, and then each test will be generated for each test case in the file.

Test templates are used; they are equivalent to raw strings and specific information
is passed in and formatted. You may see the use of debug formatting and other
oddities, this is to ensure the generated code actually compiles.

See the documentation in the [module](./mod.rs) for specific functionality.

## New Test Types

To support new test types, add the appropriate entry to the `ProcessorType` enum, and the associated `process_x` function to the `Processor` implementation.

New test types may not be necessary. For example, the `spec_tests/query_tests`,
`e2e_tests`, and `errors` tests are all distinct test suites that use the same format,
and thus, the same template. The `index_usage_tests` suite uses a different format,
so requires a different template and `process_x` function.

Future test suites may or may not reuse existing formats; it is when they
require a new format that the implementor will need to update `ProcessorType`
and `Processor`.
